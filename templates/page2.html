<!DOCTYPE html>
<html>
<head>
    <title> Ïûò ÎèÑÏ∞©ÌñàÏßÄÎ°± üåà </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    
    <style>
        body {
        display: flex; /* Flex Ïª®ÌÖåÏù¥ÎÑàÎ°ú ÏÑ§Ï†ï */
        flex-direction: column;
        justify-content: center; /* Í∞ÄÎ°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ */
        align-items: center; /* ÏÑ∏Î°ú Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ */
        }
        .matrix {
            display: block;
            margin-bottom: 20px;
        }
        .parent-category {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .category {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .category h3 {
            margin-top: 0;
        }
        tbody {
        border: 2px solid #dee2e6;
        }

        /* ÌÖåÏù¥Î∏î Î®∏Î¶¨Í∏ÄÏùò ÌÖåÎëêÎ¶¨ ÎëêÍªòÎ•º 2pxÎ°ú Ï°∞Ï†à */
        thead {
        border: 2px solid #dee2e6;
        }
    </style>
</head>
<body>
    <h1> Ïûò ÎèÑÏ∞©ÌñàÏßÄÎ°± üåà </h1>
    <h3>Ïó¨Ìñâ Í∏∞Í∞Ñ: {{ ' ~ '.join(date_range) }}</h3>

    <div class="matrix">
        <div class="parent-category">
            <h3>Ìï≠Í≥µÍ∂å</h3>
            <div class="category", name="Ìï≠Í≥µÍ∂å_to">
                <h4>Í∞ÄÎäî Ìé∏</h4>
                <table class="table text-center">
                    <thead class="table-light">
                        <tr>
                            {% if data['Ìï≠Í≥µÍ∂å_to']|length > 0 %}
                            <th name="ÏÑ†ÌÉù">ÏÑ†ÌÉù</th>
                            {% for key in data['Ìï≠Í≥µÍ∂å_to'][0].keys() %}
                            <th name="{{ key }}">{{ key }}</th>
                            {% endfor %}
                            {% endif %}
                        </tr>
                    </thead>
                    <tbody>
                        {% if data['Ìï≠Í≥µÍ∂å_to']|length > 0 %}
                        {% for item in data['Ìï≠Í≥µÍ∂å_to'] %}
                        <tr>
                            <td name="ÏÑ†ÌÉù">
                                {% if loop.index == 1 %}
                                <input type="radio" id="Ìï≠Í≥µÍ∂å_to{{ loop.index }}" name="Ìï≠Í≥µÍ∂å_to" value="{{ item }}" checked>
                                {% else %}
                                <input type="radio" id="Ìï≠Í≥µÍ∂å_to{{ loop.index }}" name="Ìï≠Í≥µÍ∂å_to" value="{{ item }}">
                                {% endif %}
                            </td>
                            {% for key, value in item.items() %}
                            <td name="{{ key }}">{{ value }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
            </div>
            <div class="category", name="Ìï≠Í≥µÍ∂å_from">
                {% if data['Ìï≠Í≥µÍ∂å_from']|length > 0 %}
                <h4>Ïò§Îäî Ìé∏</h4>
                <table class="table text-center">
                    <thead class="table-light">
                        <tr>
                            <th name="ÏÑ†ÌÉù">ÏÑ†ÌÉù</th>
                            {% for key in data['Ìï≠Í≥µÍ∂å_from'][0].keys() %}
                            <th name="{{ key }}">{{ key }}</th>
                            {% endfor %}
                        </tr>
                    </thead>
                    <tbody>
                        {% if data['Ìï≠Í≥µÍ∂å_from']|length > 0 %}
                        {% for item in data['Ìï≠Í≥µÍ∂å_from'] %}
                        <tr>
                            <td name="ÏÑ†ÌÉù">
                                {% if loop.index == 1 %}
                                <input type="radio" id="Ìï≠Í≥µÍ∂å_from{{ loop.index }}" name="Ìï≠Í≥µÍ∂å_from" value="{{ item }}" checked>
                                {% else %}
                                <input type="radio" id="Ìï≠Í≥µÍ∂å_from{{ loop.index }}" name="Ìï≠Í≥µÍ∂å_from" value="{{ item }}">
                                {% endif %}
                            </td>
                            {% for key, value in item.items() %}
                            <td name="{{ key }}">{{ value }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                        {% endif %}
                    </tbody>
                </table>
                {% endif %}
            </div>
        </div>
        <div class="parent-category", name="Ìò∏ÌÖî">
            <h3>ÏàôÎ∞ïÏãúÏÑ§</h3>
            <table class="table text-center">
                <thead class="table-light">
                    <tr>
                        {% if data['Ìò∏ÌÖî']|length > 0 %}
                        <th name="ÏÑ†ÌÉù">ÏÑ†ÌÉù</th>
                        {% for key in data['Ìò∏ÌÖî'][0].keys() %}
                        <th name="{{ key }}">{{ key }}</th>
                        {% endfor %}
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% if data['Ìò∏ÌÖî']|length > 0 %}
                    {% for item in data['Ìò∏ÌÖî'] %}
                    {% set parent_loop = loop %}
                    <tr>
                        <td name="ÏÑ†ÌÉù" class="Ìò∏ÌÖî{{ loop.index }}">
                            {% if loop.index == 1 %}
                            <input type="radio" id="Ìò∏ÌÖî{{ loop.index }}" name="Ìò∏ÌÖî" value="{{ item }}" checked>
                            {% else %}
                            <input type="radio" id="Ìò∏ÌÖî{{ loop.index }}" name="Ìò∏ÌÖî" value="{{ item }}">
                            {% endif %}
                        </td>
                        {% for key, value in item.items() %}
                        <td name="{{ key }}" id="Ìò∏ÌÖî{{ parent_loop.index }}-{{ key }}">{{ value }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                    {% endif %}
                </tbody>
            </table>
        </div>
        <div class="parent-category", name="Î†åÌä∏Ïπ¥">
            <h3>Î†åÌÑ∞Ïπ¥</h3>
            <table class="table text-center">
                <thead class="table-light">
                    <tr>
                        {% if data['Î†åÌä∏Ïπ¥']|length > 0 %}
                        <th name="ÏÑ†ÌÉù">ÏÑ†ÌÉù</th>
                        {% for key in data['Î†åÌä∏Ïπ¥'][0].keys() %}
                        <th name="{{ key }}">{{ key }}</th>
                        {% endfor %}
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% if data['Î†åÌä∏Ïπ¥']|length > 0 %}
                    {% for item in data['Î†åÌä∏Ïπ¥'] %}
                    <tr>
                        <td name="ÏÑ†ÌÉù">
                            {% if loop.index == 1 %}
                            <input type="radio" id="Î†åÌä∏Ïπ¥{{ loop.index }}" name="Î†åÌä∏Ïπ¥" value="{{ item }}" checked>
                            {% else %}
                            <input type="radio" id="Î†åÌä∏Ïπ¥{{ loop.index }}" name="Î†åÌä∏Ïπ¥" value="{{ item }}">
                            {% endif %}
                        </td>
                        {% for key, value in item.items() %}
                        <td name="{{ key }}">{{ value }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                    <tr>
                        <td name="ÏÑ†ÌÉù">
                            <input type="radio" id="Î†åÌä∏Ïπ¥uncheck" name="Î†åÌä∏Ïπ¥" value='{{ "{}" }}'>
                        </td>
                        {% for i in range(data['Î†åÌä∏Ïπ¥'][0] | length) %}
                        {% if i == 0 %}
                        <td>ÎØ∏ÏÑ†ÌÉù</td>
                        {% else %}
                        <td></td>
                        {% endif %}
                        {% endfor %}
                    </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    <button class="submit" onclick="submit()">ÏÑ†ÌÉùÏôÑÎ£å</button>

    <form id="myForm" method="get" style="display: none;" action="/3ÌéòÏù¥ÏßÄ">
        <input type="text" name="input_data" id="inputData">
        <input type="text" name="date_range" id="dateRange">
        <input type="text" name="region" id="region">
    </form>

    <script>
        function submit() {
            const selectedItems = {};
            let region = null;
            var categories = ['Ìï≠Í≥µÍ∂å_to', 'Ìï≠Í≥µÍ∂å_from', 'Ìò∏ÌÖî', 'Î†åÌä∏Ïπ¥'];
            for (var i = 0; i < categories.length; i++) {
                var radios = document.getElementsByName(categories[i]);
                for (var j = 0; j < radios.length; j++) {
                    var radio = radios[j];
                    if (radio.checked) {
                        selectedItems[categories[i]] = radio.value;
                        if (categories[i] == 'Ìò∏ÌÖî'){
                            region = document.getElementById(`${categories[i]}${j}-ÏßÄÏó≠`).textContent
                        }
                        break;
                    }
                }
            }
            document.getElementById("inputData").value = JSON.stringify(selectedItems);
            document.getElementById("dateRange").value = "{{ date_range }}"
            document.getElementById('region').value = region
            document.getElementById("myForm").submit();
        }
    </script>
</body>
</html>
